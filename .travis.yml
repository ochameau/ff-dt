language: python
python:
  - "2.7"

addons:
  apt:
    packages:
      - sshpass
      - p7zip-full
      - xvfb
env:
  - DISPLAY=':99.0'

install:
  - pip install --upgrade pip
  - source config.sh

before_script:
  - sh -e /etc/init.d/xvfb start

script:
  - if [[ "$TRAVIS_PULL_REQUEST" != "false" && "$TRAVIS_PULL_REQUEST_SHA" != "" ]] ; then
      export SHA=$TRAVIS_PULL_REQUEST_SHA;
    elif [[ "$TRAVIS_COMMIT" != "" ]] ; then
      export SHA=$TRAVIS_COMMIT;
    fi
  - echo $SHA
  - ./scripts/build-xpi.sh
  - ./scripts/upload-xpi.sh $SHA
  - ./test.sh client/framework/
